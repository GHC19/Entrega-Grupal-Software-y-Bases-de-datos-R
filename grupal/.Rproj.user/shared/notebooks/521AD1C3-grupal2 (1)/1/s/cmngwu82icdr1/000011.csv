"0","asociaciones <- list("
"0","    ""PARTIDO SOCIALISTA OBRERO ESPAÑOL"" = c("
"0","        ""PARTIDO SOCIALISTA OBRERO ESPAÑOL"", "
"0","        ""PARTIDO SOCIALISTA DE EUSKADI-EUSKADIKO EZKERRA"", "
"0","        ""PARTIT DELS SOCIALISTES DE CATALUNYA"","
"0","        ""PARTIDO DOS SOCIALISTAS DE GALICIA-PSOE"""
"0","    ),"
"0","    ""PARTIDO POPULAR"" = c("
"0","        ""PARTIDO POPULAR"", "
"0","        ""PARTIT POPULAR/PARTIDO POPULAR"", "
"0","        ""PARTIDO POPULAR/PARTIT POPULAR"", "
"0","        ""PARTIDO POPULAR - FORO"","
"0","        ""UNION DEL PUEBLO NAVARRO EN COALICION CON EL PARTIDO POPULAR"","
"0","        ""NAVARRA SUMA""  #Considero NA+ como PP"
"0","        "
"0","    ),"
"0","    ""CIUDADANOS"" = c("
"0","        ""CIUDADANOS"", "
"0","        ""CIUTADANS-PARTIDO DE LA CIUDADANIA"", "
"0","        ""CIUDADANOS-PARTIDO DE LA CIUDADANIA"""
"0","    ),"
"0","    ""PARTIDO NACIONALISTA VASCO"" = c("
"0","        ""EUZKO ALDERDI JELTZALEA-PARTIDO NACIONALISTA VASCO"","
"0","        ""NAFARROA BAI"","
"0","        ""GEROA BAI"""
"0","        "
"0","    ),"
"0","    ""BLOQUE NACIONALISTA GALLEGO"" = c("
"0","        ""BLOQUE NACIONALISTA GALLEGO"", "
"0","        ""BNG-NÓS CANDIDATURA GALEGA"""
"0","    ),"
"0","    ""UNIDAS PODEMOS - IU"" = c("
"0","        ""UNIDAS PODEMOS"", "
"0","        ""UNIDOS PODEMOS"", "
"0","        ""PODEMOS"", "
"0","        ""PODEM"", "
"0","        ""IZQUIERDA UNIDA-ALTERNATIVA"", "
"0","        ""EZKER BATUA-BERDEAK-ALTERNATIVA"", "
"0","        ""IZQUIERDA UNIDA"", "
"0","        ""ELKARREKIN PODEMOS"""
"0","    ),"
"0","    ""ESQUERRA REPUBLICANA DE CATALUNYA"" = c("
"0","        ""ESQUERRA REPUBLICANA DE CATALUNYA"", "
"0","        ""ESQUERRA REPUBLICANA/CATALUNYA SÍ"""
"0","    ),"
"0","    ""EH - BILDU"" = c("
"0","        ""EUSKAL HERRIA BILDU (EH Bildu)"","
"0","        ""EUSKAL HERRIA BILDU"","
"0","        ""EH - BILDU"", "
"0","        ""SORTU"", "
"0","        ""EUSKO ALKARTASUNA"", "
"0","        ""ARALAR"", "
"0","        ""ALTERNATIBA"""
"0","    ),"
"0","    ""VOX"" = c(""VOX"")"
"0",")"
"0",""
"0","columnas_votos <- colnames(election_data)[16:ncol(election_data)] #Selecciona todas las columnas que contienen el nombre de cada partido y sus valores son el número de votos. 'columnas_votos' será un vector que contiene el nombre de todos los partidos disponibles de este dataset. "
"0",""
"0",""
"0","columnas_por_partido <- lapply(asociaciones, function(nombres){"
"0","    intersect(nombres, columnas_votos)"
"0","}) #Para cada partido en la lista asociaciones, va recorriendo la lista 'asociaciones' aplicandole la función intersect. La cual recorre ambos vectores y devuelve las coincidencias. Así que el objeto 'columnas_por_partido' será una lista que va a contener los partidos de interés. "
"0",""
"0",""
"0","columnas_otros <- setdiff(columnas_votos, unlist(columnas_por_partido)) #identifica las columnas que están en columnas_votos pero no en columnas_por_partido"
"0",""
"0",""
"0","election_data_final <- election_data |> "
"0","    mutate( #Crea nuevas columnas sumando los votos de las columnas asociadas a cada partido. Luego con rowSums, suma fila a fila los votos correspondientes."
"0","        `PARTIDO SOCIALISTA OBRERO ESPAÑOL` = rowSums(across(all_of(columnas_por_partido[[""PARTIDO SOCIALISTA OBRERO ESPAÑOL""]])), na.rm = TRUE),"
"0","        `PARTIDO POPULAR` = rowSums(across(all_of(columnas_por_partido[[""PARTIDO POPULAR""]])), na.rm = TRUE),"
"0","        `CIUDADANOS` = rowSums(across(all_of(columnas_por_partido[[""CIUDADANOS""]])), na.rm = TRUE),"
"0","        `PARTIDO NACIONALISTA VASCO` = rowSums(across(all_of(columnas_por_partido[[""PARTIDO NACIONALISTA VASCO""]])), na.rm = TRUE),"
"0","        `BLOQUE NACIONALISTA GALLEGO` = rowSums(across(all_of(columnas_por_partido[[""BLOQUE NACIONALISTA GALLEGO""]])), na.rm = TRUE),"
"0","        `UNIDAS PODEMOS - IU` = rowSums(across(all_of(columnas_por_partido[[""UNIDAS PODEMOS - IU""]])), na.rm = TRUE),"
"0","        `ESQUERRA REPUBLICANA DE CATALUNYA` = rowSums(across(all_of(columnas_por_partido[[""ESQUERRA REPUBLICANA DE CATALUNYA""]])), na.rm = TRUE),"
"0","        `EH - BILDU` = rowSums(across(all_of(columnas_por_partido[[""EH - BILDU""]])), na.rm = TRUE),"
"0","        `VOX` = rowSums(across(all_of(columnas_por_partido[[""VOX""]])), na.rm = TRUE),"
"0","        OTROS = rowSums(across(all_of(columnas_otros)), na.rm = TRUE)"
"0","    ) |> "
"0","    select( # Reorganiza las columnas, colocando los partidos principales y OTROS después de las columnas descriptivas."
"0","        1:15, "
"0","        `PARTIDO SOCIALISTA OBRERO ESPAÑOL`, "
"0","        `PARTIDO POPULAR`, "
"0","        `CIUDADANOS`, "
"0","        `PARTIDO NACIONALISTA VASCO`, "
"0","        `BLOQUE NACIONALISTA GALLEGO`, "
"0","        `UNIDAS PODEMOS - IU`, "
"0","        `ESQUERRA REPUBLICANA DE CATALUNYA`, "
"0","        `EH - BILDU`, "
"0","        `VOX`, "
"0","        OTROS"
"0","    )"
"0",""
"0","election_data_final"
